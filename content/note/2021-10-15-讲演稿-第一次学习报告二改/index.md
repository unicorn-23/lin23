---
title: 讲演稿-第一次学习报告二改
author: Lin Gui
date: '2021-10-15'
slug: 讲演稿-第一次学习报告二改
categories:
  - 学习
tags:
  - 学习报告
---

额，大家好啊，开学以来第一次以这种形式和大家交流分享，这次呢由我来给大家大致的汇报一下从开学到现在一个月以来，大概都学了点什么。这次汇报内容主要包括神经网络和生物信息数据库。

神经网络方面我学习了标准神经网络、卷积神经网络和图神经网络，大致讲一下标准神经网络和卷积神经网络。

看，这就是一个最简单的神经网络模型，他只有一个神经元，其中X是输入，Y是输出，而这个神经元则代表了某些运算，比如这个线性运算。

我们再看一下这个稍微复杂一点的神经网络，这里呢有很多个输入，这一列呢叫输入层，他们传入这两层神经元，在这两层神经元中进行某些运算，然后获得输出值y，而其中这两层神经元的具体运算过程是由神经网络自己决定的，对于用户来说，我们只能看到输入和输出，所以除了输入和输出别的层都是隐藏层，而这最后一层因为输出值就是这个Y，所以也叫它输出层。那这个隐藏层中的每个神经元具体干了点什么呢，也就是这个神经网络具体是怎么运行的呢。

这里我们先来看一个二分类问题，了解一下什么是损失函数

假设我们给出一个训练集（X，Y），他由m个训练样本组成，其中x是n维的，因为这里是二分类问题，所以y的值是0或1。

我们将训练集中的X放入输入层，经过两层隐藏层的运算之后，将会得到这个预测值y撇。

我们给出两个参数，w和b，这个w是n维的，b是实数。

假设这个神经元中发生的运算是线性运算，也就是预测值y撇等于wx加上b，但如果是这样的话，y撇的值就有可能大于1或者是负数，不符合我们期望的y撇的取值范围，因为概率值是在0到1之间的，所以要给这个式子套上一个函数，叫sigmoid函数。

可以看到当套了这个sigmoid函数之后，不管大于1的数还是负的数都会变成0到1之间。

所以输出y撇就变成了这个样子。好的，那现在我们已经假设了：输入样本X经过神经网络运算之后，得到了的预测值y撇，而在样本中的这个Y，代表了真实值，我们现在要判断一下预测值与真实值之间的差距是多少，根据差距来对w和b进行调整，使差距变小，能更准确的进行分类，这里我们引入损失函数。

首先讲一下Loss function，这个Loss function是用来衡量单个训练样本上得到的预测值y撇和真实值y之间差距的函数，而这个Cost function则是代表了全体训练样本的表现。通常衡量两者误差大小可以使用误差平方法，误差平方的值越小，说明预测值与真实值越接近。因此使预测值变准确的过程，对于就是最小化Loss function的过程，这也就是神经网络优化的目标。而最小化Loss function的方法是梯度下降，那什么是梯度下降呢？

可以看到这里有个曲面，水平轴w和b是需要进行学习的两个参数，纵轴代表在某一点对应Loss function的值，假如这个曲面上有个点，我们要优化这个点，也就是要他朝着曲面的最低点前进。

我们来看这个简化过的曲线，也就是只看w轴和纵轴的情况，我们要做的就是使这个点，沿着这条曲线向下移动，找到最低点。

这里的参数alpha是指学习率，学习率乘以这个点的导数，就代表了他一步向下移动多少距离，而参数w不断迭代更新自身，就能逐步趋近最小值。

反过来看这里的曲面也是一样的，用这两个偏导来迭代更新参数w和b的值。但是用误差平方作为Loss function的话，会有个问题，就是可能会使刚刚的优化问题变成非凸的，导致不能求出全局最优解。

因此，我们通常会使用这个交叉熵来做为损失函数，使优化问题变成凸的，从而能够求得全局最优解，也就是全局最小值。可以看到当y等于1时，损失函数图像就变成了这样，z越大，损失函数的值就越小。

y等于0的时候也是一样的。

所以这里就使用交叉熵作为损失函数。

好的，讲好了loss function之后，我们来看一下，神经网络具体的计算过程，就是像这样子

首先将输入传到隐藏层，这个隐藏层有很多神经元，当中的每个神经元就像这样子，里面都包含一个线性函数和一个激活函数，这个激活函数可以是sigmoid函数或者是一些其他的激活函数，为什么要使用激活函数呢？因为如果不使用激活函数，那每层都做线性运算也就相当于矩阵相乘。如果使用激活函数的话，就给神经元引入了非线性因素，使得他可以任意逼近任何非线性函数。

然后将第一层隐藏层的计算结果传入输出层

输出层对传入的值进行计算会得到y撇，而这个y撇就是我们的输出预测值。这个蓝色箭头的传播过程称之为正向传播。

而对应的反向传播的过程是这样的。通过y撇我们能够得到loss function的值，而这个反向传播就利用刚才讲的梯度下降的方法，我们来单独看一下输出层的情况。

因为y撇是在输出层计算后的结果，也就是这个a的值，在这里将y撇用a代替表示

这里将L对a求导，得到da等于这个

然后根据链导法则，我们可以得出dz等于da乘上sigma(z)的导数

同理，可以得出dw和db的值

具体的推导过程

然后迭代更新w和b的值，就完成了一轮参数的更新，这个是输出层的反向传播过程。

在其他的隐藏层也是一样，用刚才的方法更新隐藏层中每个神经元里的参数w和b的值。再通过更新好的w和b，再一次进行正向传播，得到loss function的值，再从loss function进行反向传播，来不断学习里面的参数w和b。再学习过程中，loss function的值会不断减少，当loss function的值不再下降时，就停止运行神经网络，此时也就获得了w和b的最优值。那这个正向传播和反向传播的过程循环的过程就是标准神经网络的运行过程。



有什么问题吗？



大概了解了标准神经网络之后呢，我们来看一下这个卷积神经网络，这个卷积神经网络呢主要是用来处理图像数据的，他和普通的神经网络区别就在于他有一个叫卷积核的东西，也就是这个filter，他的作用呢是提取这个图像的特征

那他是怎么提取的呢？我们来看一下，假设这里有一个图片输入，他是一个7乘7的矩阵，长这样，这个卷积核是一个3乘3的矩阵，长这样。我们将这个卷积核和输入的左上角对齐，将对应位置上的数字相乘，再相加，取均值，然后放到右侧的这个输出矩阵的第一个位置上。

然后我们把卷积核向右移动一格，这个移动的距离，称为步长，假设我们现在步长为一，那和刚才的操作一样，在右边的矩阵的第二个位置就得到了-1/9，大约等于-0.1

以此类推

我们可以得到一个输出的矩阵，就像这样，这个矩阵叫feature map，这个feature map上的每一个点都是由卷积核在原图上进行卷积操作得出的，也就是这个点聚合了原图局部的特征。

现在我们换一个卷积核，他是副对角线上为1，得到的feature map是这样的

我们再使用一个两条对角线都为1的卷积核

他得出的feature map是这样的。

总的来看，我们输入一个图像样本，他经过不同的卷积核卷积之后，会得到与卷积核相同数量的feature map，他们分别提取出了图像中的某些特征。我们可以给feature map套上一个激活函数，对他做一下归一化的操作。这里我们使用ReLU function 作为激活函数。

ReLU function是这样的，也就是将小于零的数置零。

我们将左边的矩阵用ReLU进行归一化之后就能得到右侧的矩阵。

这里还有个操作叫Pooling，池化操作，目的是缩小feature map的大小，提高计算的效率。Pooling的方法呢有很多，常见的有最大和求平均这两种，他们池化的效果如图所示，这个最大池化，可以看到右侧蓝色的部分是左侧蓝色部分四个值中最大那个数，其余也是一样。平均池化则是将相同颜色相加求平均。池化操作可以将原来的矩阵缩小一半，减小计算量，同时保留原来的部分特征。

我们将刚才的feature map进行最大池化操作，得到右侧的三个新矩阵。可以看到这三个矩阵还是拥有左侧feature map的主要特征的。

接下来进行全链接操作，也就是将图像按行展开变成一维的，当中这一列叫全链接层，这也就变成了标准神经网络的输入层，随后我们就能像运行标准神经网络一样对这些数据进行处理，最后判断出他具体是什么图型。

我们可以通过重复进行卷积、归一化和池化这三个操作，来更好的提取图像的特征。



当然卷积神经网络不只能够用在图像处理上，他同时在我们研究的生物信息方向也有用武之地。这篇论文的方向是蛋白质二级结构的预测，标题是使用生成对抗网络和卷积神经网络预测蛋白质二级结构。

首先看一下他的摘要，我们可以了解到这篇文章的实验方法是利用对抗网络和卷积神经网络来预测蛋白质二级结构。

那这篇文章相对于普通的卷积神经网络预测蛋白质二级结构的创新点在于，先使用了生成对抗网络来提取数据的特征，再将融合好的特征放到卷积神经网络里进行预测。

这个是他的实验流程。可以看到同一份数据集，他进行了两种操作，来互相做对比，一种是将数据放到普通的卷积神经网络中，还有一种是刚刚讲的，也就是他的创新的地方。

然后这是他使用的数据集，这个作者使用的数据集是真的难找，如果要做文章复现的话，最好是找那种能找到源码和附了数据集的文章。

这是卷积神经网络模型。

这是生成对抗网络模型。G是生成器和D是鉴别器，这个生成对抗网络的作用是创造新的假样本，但是在我们看来这个生成的假样本也是比较真的，作者的行为在我看来就是扩大原有的训练集，来让训练获得更好的效果。

文中使用滑动窗口的长度分别为13和19，卷积层的卷积核的大小和尺寸在窗口长度为13时是11\*11\*270、11\*11\*160和在19时是19\*19\*290、16\*16\*170。在处理图像的时候这个滑动窗口大小意味着将图片分成一块块的，然后把这一块块分别放去卷积操作。但现在是在处理蛋白质序列，而蛋白质序列是字符串形式的，所以这个窗口大小也就意味着卷积网络一次要处理的序列长度。

可以看到这个窗口长度是19的时候，预测准确率还是比窗口长度等于13的时候要好一点的，这个19比13好的原因呢是因为使用长度为19的窗口可以包含更多的蛋白质特征信息。

然后作者找了几个对照组，来凸显自己的模型有多强。

然后讲一下我的复现过程，首先一开始我是盯着这篇文章准备做复现的，但他这个文章呢没有源码。于是就另找了一篇带源码的，学习了一下他的数据处理和代码思路。

首先使用的数据集是CB513，这个是一个已经处理好的数据集，用起来就很舒服了，可以看到这个数据集能用numpy进行处理，可以通过reshape，把数据集转换成N乘700乘57的形式，然后就能用了。

大概讲一下代码实现的思路，我将代码分为4部分，也就是数据处理、构建模型、训练+测试以及画图，其中比较复杂的部分是数据处理，要将数据reshape成模型想要的样子。

主要就是这样子的，数据处理模块里再分成划分训练集、测试集模块和改变训练集形状模块

然后这个模型的部分，因为这里我使用的是tensorflow的框架，只要一层层加进去就行了，需要注意的地方就是矩阵前后的形状要一致。然后反向传播的部分tensorflow框架都处理好了，直接调用就行了。

画图的话用matplotlib，将训练过程中产生的数据存在日志里，然后画一下就行了。







讲一下这个NCBI，美国国家生物技术信息中心，这个网站包含了很多东西，比如基因数据库、蛋白质数据库、BLAST测序工具、文献数据库、基因组数据库、临床的数据库等等。

我们来讲一下比较常用的Gene数据库的使用。这个是NCBI的网站首页，我们在这里选择Gene数据库，在搜索框中我们可以输入想要查询的内容，比如我们想看一下人类的基因，搜索human[orgn]，这个orgn是organism的缩写。

可以看到这个search results里面显示有6万多个items，表明人类这个物种的基因有6w多个，其中包含了蛋白编码基因和非编码基因。在左侧的Chromosome locations 我们点击more，可以用来限定染色体的位置，查看某个区域中有哪些基因。

可以看到这里显示了有 丹尼索瓦人，智人，尼安德特人。这里我们选择homo sapiens，或者选择human也是一样的。我们搜索8号染色体上的这个区域。

可以看到，在这个区域内有这三条基因。这是通过限定区域的方法寻得想要看的基因。比如我们想看MYC基因，在数据库中直接搜索的话，他会显示不止一个物种的情况。因为别的物种也包含这个基因，可以看到除了智人之外，还有家鼠，挪威鼠，果蝇等等。

我们可以通过组合基因名symbol和物种名来搜索，可以看到他可以准确的搜索到人类的MYC基因。在这个页面我们可以看到：

-   Gene ID：基因的id号。
-   基因的更新时间
-   官方名称
-   Primary source：主要来源
-   Gene type：基因的类型。编码蛋白。
-   RefSeq status：序列的状态，REVIEWED，是审核过的，其他的序列状态可能是未审核的，机器预测的。
-   Organism：物种，智人。
-   Lineage：记录这个物种的分类，也就是它属于什么门纲目科属种。
-   Also known as：曾用名。如果要找早期发布的关于这个基因的文献，可以尝试用曾用名来作为关键字搜索。
-   Summay：对基因功能的总结归纳。
-   该基因是一个原癌基因，编码一种核磷蛋白，在细胞周期进展、凋亡和细胞转化中发挥作用。编码蛋白与相关转录因子MAX形成异二聚体。该复合物与E盒DNA共有序列结合并调节特定靶基因的转录。在许多人类癌症中经常观察到该基因的扩增。涉及该基因的易位与人类伯基特淋巴瘤和多发性骨髓瘤相关。有证据表明，翻译起始于上游、帧内非AUG（CUG）和下游AUG起始位点，导致产生两种具有不同N-末端的异构体。[由RefSeq提供，2017年8月]
-   Expression：表达，在胆囊、食管和25个其他组织中普遍表达。
-   Orthologs：直系同源物种。



那通过Gene数据库，我们可以获得以下的信息。

Genomic context：中可以看到基因在8号染色体的q24.21上，有3个外显子。看下面这一部分。

MYC后面的红色箭头指向右边代表他是正向转录的，旁边的MIR 1204和下面的PVT1等等表示他的临近基因。

然后我们可以点击右上角的 See MYC in Genome Data Viewer，可以看到。

这个序列中的绿色方框的区域是外显子区域。方框中浅绿色的部分是不编码区域，通常存在于首个外显子的前半部分及末尾外显子的后半部分。

我们将下面的这条点击一下，可以看到多出了紫色和橙色的部分，其中绿色是基因片段，紫色是mRNA序列，橙色是CDS编码序列。可以看到编码序列的长度，蛋白质长度。mRNA的位置，等等。这里有一些跳转的链接，可以下载他们的FASTA格式或者去Genbank中查看。

刚刚的像NM、NP检索号的含义，在这里列了个表。

然后这个部分。

代表了基因组元件比如，DNasel信号富集位点、蛋白结合位点等，对应上方的DNA区域可能会受到转录因子或是表观遗传修饰等的调节。

往下可以看到有红色的竖线，变异类型是SNV，单核苷酸变异，他的替换基因是TCG。



点击右上方的Tracks，在推荐的Track sets里可以看到，在推荐的Track sets中，有这些，我们选择这个表观基因组学，可以看到这个基因的表观遗传修饰的信息，比如哪里有CpG岛（黑色的），H3K4me3修饰的信号情况（蓝色部分），其中信号较强的地方，说明MYC基因表达水平可能较高。

再往下，可以看到。表达谱，可以观察到在不同组织中基因的表达程度。

再往下，可以看到。该基因相关的参考文献，可以看到在pubmed中有2330篇相关参考文献，下半部分总结了文献中，该基因主要的一些功能。

再往下，可以看到这个基因的表型，有一些与他相关的一些疾病，比如肾细胞癌卵巢癌之类的。

再往下，可以看到该基因与hiv-1相互作用的相关文献。

往下是一些，基因的通路。描述了基因的某些现象、相互作用和依赖性。

再往下，列出了别的一些基因、蛋白质和该序列的相互作用。

往下是这个基因同源的物种，和他的一些功能。

往下可以看到基因对应的mRNA序列和蛋白质序列。点击这里的一致序列，可以跳转到对应的CDS区域。

好的，根据上面的信息，总结一下就是

1、MYC位于8号染色体q24.21上，有两个转录本，每个转录本均有3个外显子，正向转录，临近基因有CASC11、PVT1等。

2、MYC基因在启动子区域有多个DNase信号富集，可能受到其他转录因子或表观遗传修饰的调节。

3、H3K4me3信号较强，表达水平较高，存在两个CpG岛，可能与DNA甲基化有关，在食道、胆囊表达水平较高，在肾、心脏、甲状腺表达水平较低。

4、文献上看，该基因多与癌症有关。

然后我们看一下Nucleotide数据库。

比如我们搜索这个NG_008957。会跳转到这个单胺氧化酶的Genbank，可以看到这里显示了。

-   LOCUS   NG_008957(位点名)   97661bp(序列长度)  DNA(分子类型)    linear   PRI(物种分支) 30-NOV-2020(修改日期)
-   DEFINITION  Homo sapiens monoamine oxidase A (MAOA),智人单胺氧化酶A 。 RefSeqGene on chromosome X.(Title)X染色体上的RefSeq基因。
-   ACCESSION   NG_008957(检索号)
-   VERSION     NG_008957.2(版本号)
-   KEYWORDS    RefSeq; RefSeqGene.
-   SOURCE      Homo sapiens (human(序列来源)
    -   ORGANISM  Homo sapiens)(物种名称)
                    Eukaryota; Metazoa; Chordata; Craniata; Vertebrata; Euteleostomi;
                    Mammalia; Eutheria; Euarchontoglires; Primates; Haplorrhini;
                    Catarrhini; Hominidae; Homo.
-   REFERENCE   1  (bases 1 to 97661)(相关文献)

往下我们可以看到

FEATURES             Location/Qualifiers

-   source（生物学来源及信息）

    -   1..97661
    -   /organism="Homo sapiens"
    -   /mol_type="genomic DNA"
    -   /db_xref="taxon:9606"
    -   /chromosome="X"
    -   /map="Xp11.3"

-   gene

    -   5139..95657
    -   /gene="MAOA"
    -   /gene_synonym="BRNRS; MAO-A"
    -   /note="monoamine oxidase A"
    -   /db_xref="GeneID:4128"
    -   /db_xref="HGNC:HGNC:6833"
    -   /db_xref="MIM:309850"

-   mRNA

    -   join(5139..5254,32353..32447,42131..42268,60712..60816,
        61545..61636,77013..77154,80081..80230,80534..80693,
        81539..81635,85067..85120,89521..89578,90790..90887,
        92634..92745,92949..93011,93207..95657)
    -   /gene="MAOA"
    -   /gene_synonym="BRNRS; MAO-A"
    -   /product="monoamine oxidase A, transcript variant 1"
    -   /transcript_id="NM_000240.4"
    -   /db_xref="GeneID:4128"
    -   /db_xref="HGNC:HGNC:6833"
    -   /db_xref="MIM:309850"

-   exon（外显子）

    -   5139..5254
    -   /gene="MAOA"
    -   /gene_synonym="BRNRS; MAO-A"
    -   /inference="alignment:Splign:2.1.0"
    -   /number=1

-   CDS（编码区）

    -   join(5182..5254,32353..32447,42131..42268,60712..60816,(编码区)
        61545..61636,77013..77154,80081..80230,80534..80693,
        81539..81635,85067..85120,89521..89578,90790..90887,
        92634..92745,92949..93011,93207..93353)
    -   /gene="MAOA"
    -   /gene_synonym="BRNRS; MAO-A"
    -   /EC_number="1.4.3.4"
    -   /note="isoform 1 is encoded by transcript variant 1; amine
        oxidase [flavin-containing] A; monoamine oxidase type A"
    -   /codon_start=1
    -   /product="amine oxidase [flavin-containing] A isoform 1"
    -   /protein_id="NP_000231.1"
    -   /db_xref="CCDS:CCDS14260.1"
    -   /db_xref="GeneID:4128"
    -   /db_xref="HGNC:HGNC:6833"
    -   /db_xref="MIM:309850"
    -   /translation（可开放阅读框）？

    下面是他的序列

-   ORIGIN（序列）

    -   1 taaacgctta atgttagagg gtaatgatta agtagactag agtaggcaat tgaacataga
    -   61 gagtgaatat atatatatat atatatatat ggcatgaata tataatgtag ttttttaaaa
    -   121 attaaaatgt gaatatgtat tgagtaattc ttacatgtct ggtactaccc taaatgtttt
    -   181 aatgcatttg ctcacttaac cctcgcttca gctgtgctag atatcttcat tttgcttctc
    -   241 cgggtgctac taccacactt ctctactctg ttctggcccc tgaaggctga cctgtgtcaa
    -   301 ctaagggaaa aaaatgaagc ttttaaagaa ttacagttaa ttttatacag aagtcttact

可以查看他的FASTA格式，这里第一行大于号之后的是序列名称和注释信息

第二行及以后是他的具体序列



看一下NCBI的BLAST工具，这个

Nucleotide BLAST，blastn，核酸序列与核酸序列进行比对

Protein BLAST，blastp，蛋白质与蛋白质序列进行比对

blastx，将核酸序列翻译成蛋白质序列后，在蛋白质序列数据库中进行比对

tblastn，将蛋白质序列转换成核酸序列后，在核酸序列数据库中进行比对

点击核酸序列比对。



输入NG_008957.2他的检索号，或者输入他FASTA格式的序列就可以在整个核酸数据库中搜索与他相似的序列，可以在

-   Database中选择要搜索的数据库
-   Organism中选择物种，exclude除去某个物种
-   Program Selection，将使用的不同的比对方法
    -   Highly similar sequences，megablast，主要是用来在非常相似的序列之间（来自同一物种）比对同源性的。
    -   More dissimilar sequences, discontiguous megablast，更好地用于查找不同物种的相似的核酸序列。
    -   Somewhat similar sequences, blastn，比对的速度慢，但允许更短序列的比对

然后点击BLAST。



可以看到，第一块，Description，展示所有和原序列比对的序列，显示他们的得分

-   Description，对比对序列的描述
-   Scientific Name，物种的名称
-   Max Score，匹配分值
-   Total Score，总体分值
-   Query Coverage，覆盖率
-   E value，E（Expect）值，表示随机匹配的可能性。E值越大，随机匹配的可能性也越大。 E值接近零或为零时，具本上就是完全匹配了。E值越小越好。
-   Per.Ident，percent identity，P值，匹配一致性，即匹配上的碱基数占总序列长的百分比。P值越大越好。
-   Acc.Len，accession length，序列长度
-   Accession，检索号，点击显示该检索号对应序列的全部信息。



第二块，Graphic Summary，比对结果示意图。上方青色的Query是我们输入的序列，Alignment score，匹配程度>=200是红色



第三块，Alignments，

-   Identities：匹配度
-   Gaps：空格数

点击GenBank，可以显示到该序列与输入序列对应的信息。



第四块，Taxonomy，分类。显示在比对的结果中，大部分是什么属什么物种的。
